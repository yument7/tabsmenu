!function(a){"object"==typeof exports&&"undefined"!=typeof module?module.exports=a(require("jqurey")):"function"==typeof define&&define.amd?define(["jquery"],a):a(jQuery)}(function(_){_.fn.tabsMenu=function(a){var s={fixed_tab:{status:!0,text:"Dashboard",icon:"",src:""},prev_btn:{text:"",icon:"fa fa-backward"},back_btn:{text:"",icon:"fa fa-forward"},close_btns:!1,theme:"default",kind:"",activeKind:".active",tabsCallback:function(a){console.log(a)}};_.extend(!0,s,a);var o={index:"",current:"",active:""},f=_(this),e=s.kind,i=s.activeKind,v=s.tabsCallback;function u(a){if(a){var t=_(e+'[data-index="'+a+'"]');_(e).removeClass(i),t.addClass(i)}}function b(a){var t=h(f.children().not(".J_menuTabs")),e=_(".J_menuTab:first").outerWidth(),i=f.outerWidth(!1)-t-e,n=h(_(a).prevAll())-e,s=parseInt(_(".page-tabs-content").css("margin-left")),c=_(a).outerWidth(!0),r=s,d=0<n+c-i,l=n+s-e<0;if(0==_(a).index())r=e;else if(d){r=e-(n+c-i);var o=0-e;_(".J_menuTab").not(a).each(function(){if(o+=_(this).outerWidth(!0),e-r<o)return r=e-o,!1})}else r=l?e-n:s;_(".page-tabs-content").animate({marginLeft:r+"px"},"fast")}function h(a){var t=0;return _(a).each(function(){t+=_(this).outerWidth(!0)}),t}return function(){var a='<button class="roll-nav roll-left J_tabLeft"><i class="'+s.prev_btn.icon+'"></i></button>',t='<button class="roll-nav roll-right J_tabRight"><i class="'+s.back_btn.icon+'"></i></button>';if(f.append(a),f.append('<nav class="nav-bar J_menuTabs"><div class="page-tabs"><div class="page-tabs-content"></div></div></nav>'),f.append(t),s.fixed_tab.status){var e='<a href="javascript:;" class="active J_menuTab fixed-tab" data-src="'+s.fixed_tab.src+'" data-index="0">',i="";s.fixed_tab.icon&&(i='<i class="'+s.fixed_tab.icon+' icon"></i>'),e+=i,e+=s.fixed_tab.text+"</a>",f.find(".page-tabs-content").append(e)}if(s.close_btns){f.append('<div class="roll-nav roll-close J_tabClose"><ul class="tabs-close"><li><a href="javascript:;" class="cartbtn-switcher">关闭操作<i class="fa fa-caret-down"></i></a><dl class="tabs-close-child"><dd class="J_tabCloseAll"><a>关闭全部选项卡</a></dd><dd class="J_tabCloseOther"><a>关闭其他选项卡</a></dd></dl></li></ul></div>');var n=f.find(".J_tabClose").width();console.log(n),f.find(".J_tabRight").css("right",n)}}(),e&&(_(e).each(function(a){if(!_(this).attr("data-index")){var t=s.fixed_tab.status?a+1:a;_(this).attr("data-index",t)}}),_(e).on("click",function(a){a.preventDefault();var t=_(this).attr("href"),e=_(this).data("index"),i=_.trim(_(this).text()),n=_(this).find("i"),s=!0;if(o.index=e,null==(o.current=t)||0==_.trim(t).length)return;if(_(".J_menuTab").each(function(){if(_(this).data("index")==e&&!_(this).hasClass("active")){var a=_(this).parent().find(".J_menuTab.active").data("src");return _(this).addClass("active").siblings(".J_menuTab").removeClass("active"),b(_(this)),o.active=a,v(o),s=!1}if(_(this).data("index")==e&&_(this).hasClass("active"))return o.active=t,v(o),s=!1}),s){var c='<a href="javascript:;" class="active J_menuTab" data-src="'+t+'" data-index="'+e+'">';if(n[0]){var r=n.first(),d=r.attr("class"),l='<i class="'+d+' icon"></i>';c+=l}c+=i+' <i class="fa fa-close"></i></a>',_(".J_menuTab").removeClass("active"),_(".J_menuTabs .page-tabs-content").append(c),b(_(".J_menuTab.active")),v(o)}return u(e),!1})),f.off("click",".J_menuTab").on("click",".J_menuTab",function(){var a=_(this),t=a.data("src"),e=a.data("index");o.index=e,o.current=t,a.hasClass("active")||(o.active=a.siblings(".J_menuTab.active").data("src"),a.addClass("active").siblings(".J_menuTab").removeClass("active"),b(this),v(o));u(e)}),_(".J_menuTabs").on("click",".J_menuTab i",function(){var a=_(this).parents(".J_menuTab"),t=a.data("src");if(a.hasClass("active")){if(o.active=t,a.next(".J_menuTab").length){var e=a.next().data("src"),i=a.next().data("index");a.next().addClass("active"),a.remove(),u(i),o.index=i,o.current=e,v(o)}if(a.prev().length){var n=a.prev().data("src"),s=a.prev().data("index");a.prev().addClass("active"),a.remove(),u(s),o.index=s,o.current=n,v(o)}}else a.remove(),b(_(".J_menuTab.active"));return!1}),_(".J_tabLeft").off("click").on("click",function(){var a,t=_(".J_menuTab.active").prev();a=t.length?(t.addClass("active").siblings().removeClass("active"),t.data("src")):(_(".J_menuTab:last").addClass("active").siblings().removeClass("active"),_(".J_menuTab:last").data("src"));b(_(".J_menuTab.active")),o.current=a,v(o)}),_(".J_tabRight").off("click").on("click",function(){var a,t=_(".J_menuTab.active").next();a=t.length?(t.addClass("active").siblings().removeClass("active"),t.data("src")):(_(".J_menuTab:first").addClass("active").siblings().removeClass("active"),_(".J_menuTab:first").data("src"));b(_(".J_menuTab.active")),o.current=a,v(o)}),_(".cartbtn-switcher").off("click").on("click",function(){_(this).find("i.fa").toggleClass("fa-caret-down").toggleClass("fa-caret-left"),_(this).next().toggleClass("show-hide")}),_(".J_tabCloseAll").on("click",function(){if(s.fixed_tab.status){_(".page-tabs-content").children("[data-index]").not(":first").each(function(){_(this).remove()});var a=_(".page-tabs-content").children("[data-index]:first");a.addClass("active"),o.current=a.data("src"),o.index=a.data("index"),v(o)}else _(".page-tabs-content").children("[data-index]").each(function(){_(this).remove()}),v(o);_(".cartbtn-switcher").trigger("click")}),_(".J_tabCloseOther").on("click",function(){s.fixed_tab.status?_(".page-tabs-content").children("[data-index]").not(":first").not(".active").each(function(){_(this).remove()}):_(".page-tabs-content").children("[data-index]").not(".active").each(function(){_(this).remove()});_(".cartbtn-switcher").trigger("click")}),this}});