(function(a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a(require("jqurey")):typeof define==="function"&&define.amd?define(["jquery"],a):a(jQuery)})(function(T){T.fn.tabsMenu=function(a){var d={fixed_tab:{status:true,text:"Dashboard",icon:"",src:""},prev_btn:{text:"",icon:"fa fa-backward"},back_btn:{text:"",icon:"fa fa-forward"},close_btns:false,theme:"default",main_items:{kind:"",activeKind:".active"},other_items:{kind:"",activeKind:".active",isActive:false},tabsCallback:function(a){}};T.extend(true,d,a);var v={index:"",current:"",active:""};var o=T(this);var e=d.main_items.kind,i=d.main_items.activeKind;var n=d.other_items.kind,s=d.other_items.activeKind,c=d.other_items.isActive;var r=0;var f=d.tabsCallback;t();function t(){var a='<button class="roll-nav roll-left J_tabLeft"><i class="'+d.prev_btn.icon+'"></i></button>';var t='<button class="roll-nav roll-right J_tabRight"><i class="'+d.back_btn.icon+'"></i></button>';var e='<nav class="nav-bar J_menuTabs"><div class="page-tabs"><div class="page-tabs-content"></div></div></nav>';o.append(a);o.append(e);o.append(t);var i=d.fixed_tab.status;if(i){var n='<a href="javascript:;" class="active J_menuTab fixed-tab" data-src="'+d.fixed_tab.src+'" data-index="0">';var s="";if(d.fixed_tab.icon){s='<i class="'+d.fixed_tab.icon+' icon"></i>'}n+=s;n+=d.fixed_tab.text+"</a>";o.find(".page-tabs-content").append(n)}if(d.close_btns){var c='<div class="roll-nav roll-close J_tabClose"><ul class="tabs-close"><li><a href="javascript:;" class="cartbtn-switcher">关闭操作<i class="fa fa-caret-down"></i></a>'+'<dl class="tabs-close-child"><dd class="J_tabCloseAll"><a>关闭全部选项卡</a></dd><dd class="J_tabCloseOther"><a>关闭其他选项卡</a></dd></dl></li></ul></div>';o.append(c);var r=o.find(".J_tabClose").width();console.log(r);o.find(".J_tabRight").css("right",r)}}if(e){T(e).each(function(a){if(!T(this).attr("data-index")){var t=d.fixed_tab.status?a+1:a;r=t;T(this).attr("data-index",t)}});T(e).on("click",l)}if(n){T(n).each(function(a){if(!T(this).attr("data-index")){var t=r+a+1;T(this).attr("data-index",t)}});T(n).on("click",l)}o.off("click",".J_menuTab").on("click",".J_menuTab",u);T(".J_menuTabs").on("click",".J_menuTab i",_);T(".J_tabLeft").off("click").on("click",h);T(".J_tabRight").off("click").on("click",m);T(".cartbtn-switcher").off("click").on("click",x);T(".J_tabCloseAll").on("click",p);T(".J_tabCloseOther").on("click",g);function l(a){a.preventDefault();var t=T(this).attr("href"),e=T(this).data("index"),i=T.trim(T(this).text()),n=T(this).find("i"),s=true;v.index=e;v.current=t;if(t==undefined||T.trim(t).length==0){return}T(".J_menuTab").each(function(){if(T(this).data("index")==e&&!T(this).hasClass("active")){var a=T(this).parent().find(".J_menuTab.active").data("src");T(this).addClass("active").siblings(".J_menuTab").removeClass("active");J(T(this));v.active=a;f(v);s=false;return false}if(T(this).data("index")==e&&T(this).hasClass("active")){v.active=t;f(v);s=false;return false}});if(s){var c='<a href="javascript:;" class="active J_menuTab" data-src="'+t+'" data-index="'+e+'">';if(n[0]){var r=n.first();var d=r.attr("class");var l='<i class="'+d+' icon"></i>';c+=l}c+=i+' <i class="fa fa-close"></i></a>';T(".J_menuTab").removeClass("active");T(".J_menuTabs .page-tabs-content").append(c);J(T(".J_menuTab.active"));f(v)}b(e);return false}function u(){var a=T(this);var t=a.data("src"),e=a.data("index");v.index=e;v.current=t;if(!a.hasClass("active")){v.active=a.siblings(".J_menuTab.active").data("src");a.addClass("active").siblings(".J_menuTab").removeClass("active");J(this);f(v)}b(e)}function b(a){if(a&&a<=r){var t=T(e+'[data-index="'+a+'"]');T(e).removeClass(i);t.addClass(i)}if(a&&a>r&&c){var t=T(n+'[data-index="'+a+'"]');T(n).removeClass(s);t.addClass(s)}}function h(){var a=T(".J_menuTab.active").prev();var t;if(a.length){a.addClass("active").siblings().removeClass("active");t=a.data("src")}else{T(".J_menuTab:last").addClass("active").siblings().removeClass("active");t=T(".J_menuTab:last").data("src")}J(T(".J_menuTab.active"));v.current=t;f(v)}function m(){var a=T(".J_menuTab.active").next();var t;if(a.length){a.addClass("active").siblings().removeClass("active");t=a.data("src")}else{T(".J_menuTab:first").addClass("active").siblings().removeClass("active");t=T(".J_menuTab:first").data("src")}J(T(".J_menuTab.active"));v.current=t;f(v)}function _(){var a=T(this).parents(".J_menuTab");var t=a.data("src");if(a.hasClass("active")){v.active=t;if(a.next(".J_menuTab").length){var e=a.next().data("src");var i=a.next().data("index");a.next().addClass("active");a.remove();b(i);v.index=i;v.current=e;f(v)}if(a.prev().length){var n=a.prev().data("src");var s=a.prev().data("index");a.prev().addClass("active");a.remove();b(s);v.index=s;v.current=n;f(v)}}else{a.remove();J(T(".J_menuTab.active"))}return false}function x(){T(this).find("i.fa").toggleClass("fa-caret-down").toggleClass("fa-caret-left");T(this).next().toggleClass("show-hide")}function p(){if(d.fixed_tab.status){T(".page-tabs-content").children("[data-index]").not(":first").each(function(){T(this).remove()});var a=T(".page-tabs-content").children("[data-index]:first");a.addClass("active");v.current=a.data("src");v.index=a.data("index");f(v)}else{T(".page-tabs-content").children("[data-index]").each(function(){T(this).remove()});f(v)}T(".cartbtn-switcher").trigger("click")}function g(){if(d.fixed_tab.status){T(".page-tabs-content").children("[data-index]").not(":first").not(".active").each(function(){T(this).remove()})}else{T(".page-tabs-content").children("[data-index]").not(".active").each(function(){T(this).remove()})}T(".cartbtn-switcher").trigger("click")}function J(a){var t=C(o.children().not(".J_menuTabs"));var e=T(".J_menuTab:first").outerWidth();var i=o.outerWidth(false)-t-e;var n=C(T(a).prevAll())-e;var s=parseInt(T(".page-tabs-content").css("margin-left"));var c=T(a).outerWidth(true);var r=s;var d=n+c-i>0;var l=n+s-e<0;if(T(a).index()==0){r=e}else{if(d){r=e-(n+c-i);var v=0-e;T(".J_menuTab").not(a).each(function(){v+=T(this).outerWidth(true);if(v>e-r){r=e-v;return false}})}else if(l){r=e-n}else{r=s}}T(".page-tabs-content").animate({marginLeft:r+"px"},"fast")}function C(a){var t=0;T(a).each(function(){t+=T(this).outerWidth(true)});return t}return this}});