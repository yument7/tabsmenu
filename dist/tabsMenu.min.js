(function(a){typeof exports==="object"&&typeof module!=="undefined"?module.exports=a(require("jqurey")):typeof define==="function"&&define.amd?define(["jquery"],a):a(jQuery)})(function(C){C.fn.tabsMenu=function(a){var d={fixed_tab:{status:true,text:"Dashboard",icon:"",src:""},prev_btn:{text:"",icon:"fa fa-backward"},back_btn:{text:"",icon:"fa fa-forward"},close_btns:false,theme:"default",main_items:{kind:"",activeKind:".active"},other_items:{kind:"",activeKind:".active",isActive:false},tabsCallback:function(a){}};C.extend(true,d,a);var o={index:"",current:"",active:""};var v=C(this);var e=d.main_items.kind,i=d.main_items.activeKind;var n=d.other_items.kind,s=d.other_items.activeKind,c=d.other_items.isActive;var f=d.tabsCallback;t();function t(){var a='<button class="roll-nav roll-left J_tabLeft"><i class="'+d.prev_btn.icon+'"></i></button>';var t='<button class="roll-nav roll-right J_tabRight"><i class="'+d.back_btn.icon+'"></i></button>';var e='<nav class="nav-bar J_menuTabs"><div class="page-tabs"><div class="page-tabs-content"></div></div></nav>';v.append(a);v.append(e);v.append(t);var i=d.fixed_tab.status;if(i){var n='<a href="javascript:;" class="active J_menuTab fixed-tab" data-src="'+d.fixed_tab.src+'" data-index="0">';var s="";if(d.fixed_tab.icon){s='<i class="'+d.fixed_tab.icon+' icon"></i>'}n+=s;n+=d.fixed_tab.text+"</a>";v.find(".page-tabs-content").append(n)}if(d.close_btns){var c='<div class="roll-nav roll-close J_tabClose"><ul class="tabs-close"><li><a href="javascript:;" class="cartbtn-switcher">关闭操作<i class="fa fa-caret-down"></i></a>'+'<dl class="tabs-close-child"><dd class="J_tabCloseAll"><a>关闭全部选项卡</a></dd><dd class="J_tabCloseOther"><a>关闭其他选项卡</a></dd></dl></li></ul></div>';v.append(c);var r=v.find(".J_tabClose").width();console.log(r);v.find(".J_tabRight").css("right",r)}}if(e){C(e).each(function(a){if(!C(this).attr("data-index")){var t=d.fixed_tab.status?a+1:a;C(this).attr("data-index",t)}});C(e).on("click",r)}if(n){C(n).each(function(a){if(!C(this).attr("data-index")){var t=indexCount+a+1;C(this).attr("data-index",t)}});C(n).on("click",r)}v.off("click",".J_menuTab").on("click",".J_menuTab",l);C(".J_menuTabs").on("click",".J_menuTab i",m);C(".J_tabLeft").off("click").on("click",b);C(".J_tabRight").off("click").on("click",h);C(".cartbtn-switcher").off("click").on("click",_);C(".J_tabCloseAll").on("click",x);C(".J_tabCloseOther").on("click",p);function r(a){a.preventDefault();var t=C(this).attr("href"),e=C(this).data("index"),i=C.trim(C(this).text()),n=C(this).find("i"),s=true;o.index=e;o.current=t;if(t==undefined||C.trim(t).length==0){return}C(".J_menuTab").each(function(){if(C(this).data("index")==e&&!C(this).hasClass("active")){var a=C(this).parent().find(".J_menuTab.active").data("src");C(this).addClass("active").siblings(".J_menuTab").removeClass("active");g(C(this));o.active=a;f(o);s=false;return false}if(C(this).data("index")==e&&C(this).hasClass("active")){o.active=t;f(o);s=false;return false}});if(s){var c='<a href="javascript:;" class="active J_menuTab" data-src="'+t+'" data-index="'+e+'">';if(n[0]){var r=n.first();var d=r.attr("class");var l='<i class="'+d+' icon"></i>';c+=l}c+=i+' <i class="fa fa-close"></i></a>';C(".J_menuTab").removeClass("active");C(".J_menuTabs .page-tabs-content").append(c);g(C(".J_menuTab.active"));f(o)}u(e);return false}function l(){var a=C(this);var t=a.data("src"),e=a.data("index");o.index=e;o.current=t;if(!a.hasClass("active")){o.active=a.siblings(".J_menuTab.active").data("src");a.addClass("active").siblings(".J_menuTab").removeClass("active");g(this);f(o)}u(e)}function u(a){if(a&&a<=indexCount){var t=C(e+'[data-index="'+a+'"]');C(e).removeClass(i);t.addClass(i)}if(a&&a>indexCount&&c){var t=C(n+'[data-index="'+a+'"]');C(n).removeClass(s);t.addClass(s)}}function b(){var a=C(".J_menuTab.active").prev();var t;if(a.length){a.addClass("active").siblings().removeClass("active");t=a.data("src")}else{C(".J_menuTab:last").addClass("active").siblings().removeClass("active");t=C(".J_menuTab:last").data("src")}g(C(".J_menuTab.active"));o.current=t;f(o)}function h(){var a=C(".J_menuTab.active").next();var t;if(a.length){a.addClass("active").siblings().removeClass("active");t=a.data("src")}else{C(".J_menuTab:first").addClass("active").siblings().removeClass("active");t=C(".J_menuTab:first").data("src")}g(C(".J_menuTab.active"));o.current=t;f(o)}function m(){var a=C(this).parents(".J_menuTab");var t=a.data("src");if(a.hasClass("active")){o.active=t;if(a.next(".J_menuTab").length){var e=a.next().data("src");var i=a.next().data("index");a.next().addClass("active");a.remove();u(i);o.index=i;o.current=e;f(o)}if(a.prev().length){var n=a.prev().data("src");var s=a.prev().data("index");a.prev().addClass("active");a.remove();u(s);o.index=s;o.current=n;f(o)}}else{a.remove();g(C(".J_menuTab.active"))}return false}function _(){C(this).find("i.fa").toggleClass("fa-caret-down").toggleClass("fa-caret-left");C(this).next().toggleClass("show-hide")}function x(){if(d.fixed_tab.status){C(".page-tabs-content").children("[data-index]").not(":first").each(function(){C(this).remove()});var a=C(".page-tabs-content").children("[data-index]:first");a.addClass("active");o.current=a.data("src");o.index=a.data("index");f(o)}else{C(".page-tabs-content").children("[data-index]").each(function(){C(this).remove()});f(o)}C(".cartbtn-switcher").trigger("click")}function p(){if(d.fixed_tab.status){C(".page-tabs-content").children("[data-index]").not(":first").not(".active").each(function(){C(this).remove()})}else{C(".page-tabs-content").children("[data-index]").not(".active").each(function(){C(this).remove()})}C(".cartbtn-switcher").trigger("click")}function g(a){var t=J(v.children().not(".J_menuTabs"));var e=C(".J_menuTab:first").outerWidth();var i=v.outerWidth(false)-t-e;var n=J(C(a).prevAll())-e;var s=parseInt(C(".page-tabs-content").css("margin-left"));var c=C(a).outerWidth(true);var r=s;var d=n+c-i>0;var l=n+s-e<0;if(C(a).index()==0){r=e}else{if(d){r=e-(n+c-i);var o=0-e;C(".J_menuTab").not(a).each(function(){o+=C(this).outerWidth(true);if(o>e-r){r=e-o;return false}})}else if(l){r=e-n}else{r=s}}C(".page-tabs-content").animate({marginLeft:r+"px"},"fast")}function J(a){var t=0;C(a).each(function(){t+=C(this).outerWidth(true)});return t}return this}});